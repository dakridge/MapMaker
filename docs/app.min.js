!function(n){function t(t){for(var i,o,r=t[0],h=t[1],c=t[2],u=0,d=[];u<r.length;u++)o=r[u],s[o]&&d.push(s[o][0]),s[o]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(n[i]=h[i]);for(l&&l(t);d.length;)d.shift()();return a.push.apply(a,c||[]),e()}function e(){for(var n,t=0;t<a.length;t++){for(var e=a[t],i=!0,r=1;r<e.length;r++){var h=e[r];0!==s[h]&&(i=!1)}i&&(a.splice(t--,1),n=o(o.s=e[0]))}return n}var i={},s={0:0},a=[];function o(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=n,o.c=i,o.d=function(n,t,e){o.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,t){if(1&t&&(n=o(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)o.d(e,i,function(t){return n[t]}.bind(null,i));return e},o.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(t,"a",t),t},o.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},o.p="";var r=window.webpackJsonp=window.webpackJsonp||[],h=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var l=h;a.push([24,1]),e()}({23:function(n,t,e){var i=e(37);"string"==typeof i&&(i=[[n.i,i,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};e(16)(i,s);i.locals&&(n.exports=i.locals)},24:function(n,t,e){n.exports=e(38)},35:function(n,t,e){(t=n.exports=e(15)(!1)).push([n.i,"._2KwuXAvKbGhLpj4P4f_dW_ {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n._2KwuXAvKbGhLpj4P4f_dW_ canvas {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n",""]),t.locals={Container:"_2KwuXAvKbGhLpj4P4f_dW_"}},37:function(n,t,e){(t=n.exports=e(15)(!1)).push([n.i,'html {\n  font-family: sans-serif;\n  -ms-text-size-adjust: 100%;\n  -webkit-text-size-adjust: 100%;\n}\nbody {\n  margin: 0;\n}\narticle,\naside,\ndetails,\nfigcaption,\nfigure,\nfooter,\nheader,\nmain,\nmenu,\nnav,\nsection,\nsummary {\n  display: block;\n}\naudio,\ncanvas,\nprogress,\nvideo {\n  display: inline-block;\n}\naudio:not([controls]) {\n  display: none;\n  height: 0;\n}\nprogress {\n  vertical-align: baseline;\n}\ntemplate,\n[hidden] {\n  display: none;\n}\na {\n  background-color: transparent;\n  -webkit-text-decoration-skip: objects;\n}\na:active,\na:hover {\n  outline-width: 0;\n}\nabbr[title] {\n  border-bottom: none;\n  text-decoration: underline;\n  text-decoration: underline dotted;\n}\nb,\nstrong {\n  font-weight: inherit;\n}\nb,\nstrong {\n  font-weight: bolder;\n}\ndfn {\n  font-style: italic;\n}\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\nmark {\n  background-color: #ff0;\n  color: #000;\n}\nsmall {\n  font-size: 80%;\n}\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\nsub {\n  bottom: -0.25em;\n}\nsup {\n  top: -0.5em;\n}\nimg {\n  border-style: none;\n}\nsvg:not(:root) {\n  overflow: hidden;\n}\ncode,\nkbd,\npre,\nsamp {\n  font-family: monospace, monospace;\n  font-size: 1em;\n}\nfigure {\n  margin: 1em 40px;\n}\nhr {\n  box-sizing: content-box;\n  height: 0;\n  overflow: visible;\n}\nbutton,\ninput,\nselect,\ntextarea {\n  font: inherit;\n  margin: 0;\n}\noptgroup {\n  font-weight: bold;\n}\nbutton,\ninput {\n  overflow: visible;\n}\nbutton,\nselect {\n  text-transform: none;\n}\nbutton,\nhtml [type="button"],\n[type="reset"],\n[type="submit"] {\n  -webkit-appearance: button;\n}\nbutton::-moz-focus-inner,\n[type="button"]::-moz-focus-inner,\n[type="reset"]::-moz-focus-inner,\n[type="submit"]::-moz-focus-inner {\n  border-style: none;\n  padding: 0;\n}\nbutton:-moz-focusring,\n[type="button"]:-moz-focusring,\n[type="reset"]:-moz-focusring,\n[type="submit"]:-moz-focusring {\n  outline: 1px dotted ButtonText;\n}\nfieldset {\n  border: 1px solid #c0c0c0;\n  margin: 0 2px;\n  padding: 0.35em 0.625em 0.75em;\n}\nlegend {\n  box-sizing: border-box;\n  color: inherit;\n  display: table;\n  max-width: 100%;\n  padding: 0;\n  white-space: normal;\n}\ntextarea {\n  overflow: auto;\n}\n[type="checkbox"],\n[type="radio"] {\n  box-sizing: border-box;\n  padding: 0;\n}\n[type="number"]::-webkit-inner-spin-button,\n[type="number"]::-webkit-outer-spin-button {\n  height: auto;\n}\n[type="search"] {\n  -webkit-appearance: textfield;\n  outline-offset: -2px;\n}\n[type="search"]::-webkit-search-cancel-button,\n[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n::-webkit-input-placeholder {\n  color: inherit;\n  opacity: 0.54;\n}\n::-webkit-file-upload-button {\n  -webkit-appearance: button;\n  font: inherit;\n}\ndiv {\n  position: relative;\n}\n._31GHIL9GZCB-2o45MKhqNd {\n  position: relative;\n}\n',""]),t.locals={Main:"_31GHIL9GZCB-2o45MKhqNd"}},38:function(n,t,e){"use strict";e.r(t);var i=e(0),s=e.n(i),a=e(18),o=e.n(a),r=(e(17),function(){}),h=e(2),c=e.n(h),l=e(3),u=e.n(l),d=e(4),p=e.n(d),v=e(6),f=e.n(v),b=e(7),g=e.n(b),m=(e(1),e(5)),y=e.n(m),w=function(){function n(t){var e=this;c()(this,n),this.draw=this.draw.bind(this),this.init=this.init.bind(this);this.canvases={},this.contexts={},this.canvasWidth=t.getBoundingClientRect().width,this.canvasHeight=t.getBoundingClientRect().height,["Main"].forEach(function(n){e.canvases[n]=document.createElement("canvas"),e.canvases[n].width=e.canvasWidth,e.canvases[n].height=e.canvasHeight,e.canvases[n].classList.add("".concat(n)),t.append(e.canvases[n]),e.contexts[n]=e.canvases[n].getContext("2d")}),this.state={lastX:0,lastY:0,isMousePressed:!1},this.init()}return u()(n,[{key:"draw",value:function(n,t,e){var i=this.state,s=i.lastX,a=i.lastY,o=this.contexts.Main;e&&(o.beginPath(),o.strokeStyle="blue",o.lineWidth=4,o.lineJoin="round",o.moveTo(s,a),o.lineTo(n,t),o.closePath(),o.stroke()),this.state.lastX=n,this.state.lastY=t}},{key:"init",value:function(){var n=this,t=this.canvases.Main;this.contexts.Main;t.addEventListener("mousemove",function(e){var i=e.clientY-t.offsetTop,s=e.clientX-t.offsetLeft;n.state.isMousePressed&&n.draw(s,i,!0)},!1),t.addEventListener("mousedown",function(e){var i=e.clientY-t.offsetTop,s=e.clientX-t.offsetLeft;n.state.isMousePressed=!0,n.draw(s,i,!1)},!1),t.addEventListener("mouseup",function(){n.state.isMousePressed=!1},!1),t.addEventListener("mouseout",function(){n.state.isMousePressed=!1},!1)}}]),n}(),x=e(22),k=function(n,t){return{x:n.x+(t.x-n.x)/2,y:n.y+(t.y-n.y)/2}},P=function(){function n(t){var e=this;c()(this,n),this.init=this.init.bind(this),this.loop=this.loop.bind(this),this.clearCanvas=this.clearCanvas.bind(this),this.handlePointerMove=this.handlePointerMove.bind(this),this.handlePointerDown=this.handlePointerDown.bind(this),this.handlePointerUp=this.handlePointerUp.bind(this),this.drawGrid=this.drawGrid.bind(this),this.drawInterface=this.drawInterface.bind(this);this.state={isDrawing:!1,isPressing:!1,mouseHasMoved:!1,valuesChanged:!1},this.props={padding:100,gridBoxSize:25,isDebug:!0,lazyRadius:80,brushRadius:10,colorDebug:"#FF44B1",colorBrush:"#043EC7",colorInk:"#0799EE"},this.canvases={},this.contexts={},this.canvasWidth=t.getBoundingClientRect().width,this.canvasHeight=t.getBoundingClientRect().height,["Main","Grid","Temp","UI"].forEach(function(n){e.canvases[n]=document.createElement("canvas"),e.canvases[n].width=e.canvasWidth,e.canvases[n].height=e.canvasHeight,e.canvases[n].classList.add("".concat(n)),t.append(e.canvases[n]),e.contexts[n]=e.canvases[n].getContext("2d")}),this.points=[],this.mapSize=Math.min(this.canvasWidth,this.canvasHeight)-2*this.props.padding,this.position0=[.5*(this.canvasWidth-this.mapSize),.5*(this.canvasHeight-this.mapSize)],this.brush=new x.LazyBrush({radius:this.props.lazyRadius,enabled:!0,initialPoint:{x:this.canvasWidth/2,y:this.canvasHeight/2}}),this.init()}return u()(n,[{key:"init",value:function(){var n=this;this.drawGrid(),this.canvases.UI.addEventListener("mousedown",this.handlePointerDown.bind(this)),this.canvases.UI.addEventListener("mouseup",this.handlePointerUp.bind(this)),this.canvases.UI.addEventListener("mousemove",function(t){return n.handlePointerMove(t.clientX,t.clientY)}),this.loop(),window.setTimeout(function(){var t=window.innerWidth/2,e=window.innerHeight/2;n.brush.update({x:t-n.props.lazyRadius/4,y:e},{both:!0}),n.brush.update({x:t+n.props.lazyRadius/4,y:e},{both:!1}),n.state.mouseHasMoved=!0,n.state.valuesChanged=!0,n.clearCanvas()},100)}},{key:"loop",value:function(){var n=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).once,e=void 0!==t&&t;if(this.state.mouseHasMoved||this.state.valuesChanged){var i=this.brush.getPointerCoordinates(),s=this.brush.getBrushCoordinates();this.drawInterface(i,s),this.state.mouseHasMoved=!1,this.state.valuesChanged=!1}e||window.requestAnimationFrame(function(){n.loop()})}},{key:"clearCanvas",value:function(){this.state.valuesChanged=!0,this.contexts.Main.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.contexts.Temp.clearRect(0,0,this.canvasWidth,this.canvasHeight)}},{key:"handlePointerMove",value:function(n,t){var e=this.brush.update({x:n,y:t}),i=!this.brush.isEnabled();if(this.contexts.Temp.lineJoin="round",this.contexts.Temp.lineCap="round",this.contexts.Temp.strokeStyle=this.props.colorInk,(this.state.isPressing&&e&&!this.state.isDrawing||i&&this.state.isPressing)&&(this.state.isDrawing=!0,this.points.push(this.brush.brush.toObject())),this.state.isDrawing&&(this.brush.brushHasMoved()||i)){this.contexts.Temp.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.contexts.Temp.lineWidth=2*this.props.brushRadius,this.points.push(this.brush.brush.toObject());var s=this.points[0],a=this.points[1];this.contexts.Temp.moveTo(a.x,a.y),this.contexts.Temp.beginPath();for(var o=1,r=this.points.length;o<r;o++){var h=k(s,a);this.contexts.Temp.quadraticCurveTo(s.x,s.y,h.x,h.y),s=this.points[o],a=this.points[o+1]}this.contexts.Temp.lineTo(s.x,s.y),this.contexts.Temp.stroke()}this.state.mouseHasMoved=!0}},{key:"handlePointerDown",value:function(n){n.preventDefault(),this.state.isPressing=!0}},{key:"handlePointerUp",value:function(n){n.preventDefault(),this.state.isDrawing=!1,this.state.isPressing=!1,this.points.length=0;var t=window.innerWidth>1024?1:window.devicePixelRatio,e=this.canvases.Temp.width/t,i=this.canvases.Temp.height/t;this.contexts.Temp.clearRect(0,0,e,i)}},{key:"drawGrid",value:function(){var n=this.contexts,t=this.props,e=this.mapSize,i=this.position0,s=t.gridBoxSize,a=n.Grid;a.clearRect(0,0,e,e),a.fillStyle="#85D853",a.fillRect(i[0],i[1],this.mapSize,this.mapSize),this.props.isDebug&&(a.fillStyle=this.props.colorDebug,a.fillRect(i[0]-2,i[1]-2,5,5),a.fillRect(i[0]+e-2,i[1]-2,5,5),a.fillRect(i[0]-2,i[1]+e-2,5,5),a.fillRect(i[0]+e-2,i[1]+e-2,5,5)),a.beginPath(),a.strokeStyle="rgba(0, 0, 0, 0.1)",a.lineWidth=.5;for(var o=i[0];o<e+i[0]+s;)a.moveTo(o,i[1]),a.lineTo(o,e+i[1]),o+=s;a.stroke();for(var r=i[1];r<e+i[1]+s;)a.moveTo(i[0],r),a.lineTo(e+i[0],r),r+=s;a.stroke()}},{key:"drawInterface",value:function(n,t){var e=this.contexts.UI;e.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.props.isDebug&&(e.fillStyle=this.props.colorDebug,e.fillText("[".concat(t.x,", ").concat(t.y,"]"),10,15)),e.beginPath(),e.fillStyle=this.props.colorBrush,e.arc(t.x,t.y,this.props.brushRadius,0,2*Math.PI,!0),e.fill()}}]),n}(),z=e(9),C=e.n(z),M=function(n){function t(n){var e;return c()(this,t),(e=p()(this,f()(t).call(this,n))).handleChange=e.handleChange.bind(y()(y()(e))),e.state={isLazy:!1},e.canvasContainer=s.a.createRef(),e}return g()(t,n),u()(t,[{key:"componentDidMount",value:function(){"?lazy=true"!==window.location.search?this.sceneController=new w(this.canvasContainer.current):this.sceneController=new P(this.canvasContainer.current)}},{key:"componentDidUpdate",value:function(n,t){this.state.isLazy,t.isLazy}},{key:"handleChange",value:function(){this.setState({isLazy:!this.state.isLazy})}},{key:"render",value:function(){return console.log(C.a),s.a.createElement("div",null,s.a.createElement("div",{className:C.a.Main,style:{width:1e3,height:800,border:"1px solid #ddd"}},s.a.createElement("div",{className:C.a.Container,ref:this.canvasContainer})))}}]),t}(s.a.PureComponent),T=e(23),R=e.n(T),E=function(n){function t(){return c()(this,t),p()(this,f()(t).apply(this,arguments))}return g()(t,n),u()(t,[{key:"render",value:function(){return s.a.createElement("div",{className:R.a.Main},s.a.createElement(M,null))}}]),t}(s.a.PureComponent);r();o.a.render(s.a.createElement(E,null),document.getElementById("root"))},9:function(n,t,e){var i=e(35);"string"==typeof i&&(i=[[n.i,i,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};e(16)(i,s);i.locals&&(n.exports=i.locals)}});
//# sourceMappingURL=app.min.js.map